import dataclasses
import unittest

import numpy as np

from cltl.vector_id.clusterid import ClusterIdentity


@dataclasses.dataclass
class TestCluster:
    labels_: list

class TestClustering:
    """Cluster id is determined by the first dimension of the vector being zero."""
    def fit(self, X):
        return TestCluster(X[:, 0] == 0)


class TestAgglomerativeVectorId(unittest.TestCase):
    def test_empty(self):
        vector_id = ClusterIdentity(TestClustering(), 3)
        self.assertEqual((0, 3), vector_id._representations.shape)

    def test_add_one_dimensional(self):
        vector_id = ClusterIdentity(TestClustering(), 3)

        vector_id.add(np.array([0,3,4]))
        vector_id.add(np.array([0,3,4]))

        np.testing.assert_array_almost_equal([[0,3,4], [0,3,4]], vector_id._representations)
        np.testing.assert_array_equal([0,3/5,4/5], next(iter(vector_id._centroids.values())))

    def test_add_first(self):
        vector_id = ClusterIdentity(TestClustering(), 3)

        vector_id.add(np.array([[0,3,4]]))

        np.testing.assert_array_almost_equal([[0,3,4]], vector_id._representations)
        np.testing.assert_array_equal([0,3/5,4/5], next(iter(vector_id._centroids.values())))

    def test_add_one_cluster(self):
        vector_id = ClusterIdentity(TestClustering(), 3)

        vector_id.add(np.array([[0,3,4], [0,3,4]]))

        np.testing.assert_array_equal([[0,3,4], [0,3,4]], vector_id._representations)
        np.testing.assert_array_almost_equal([0,3/5,4/5], next(iter(vector_id._centroids.values())))

    def test_add_two_clusters(self):
        vector_id = ClusterIdentity(TestClustering(), 3)

        vector_id.add(np.array([[0,3,4], [0,3,4], [5,12,0], [5,12,0]]))

        np.testing.assert_array_equal([[0,3,4], [0,3,4], [5,12,0], [5,12,0]], vector_id._representations)

        centroids = list(sorted([tuple(cent) for cent in vector_id._centroids.values()]))
        self.assertEqual(2, len(centroids))
        np.testing.assert_array_almost_equal([0,3/5,4/5], centroids[0])
        np.testing.assert_array_almost_equal([5/13,12/13,0], centroids[1])

    def test_add_two_clusters_one_by_one(self):
        vector_id = ClusterIdentity(TestClustering(), 3)

        id_1 = vector_id.add(np.array([[0,3,4]]))
        id_2 = vector_id.add(np.array([[0,3,4]]))
        id_3 = vector_id.add(np.array([[5,12,0]]))
        id_4 = vector_id.add(np.array([[5,12,0]]))

        np.testing.assert_array_equal([[0,3,4], [0,3,4], [5,12,0], [5,12,0]], vector_id._representations)

        centroids = list(sorted([tuple(cent) for cent in vector_id._centroids.values()]))
        self.assertEqual(2, len(centroids))
        np.testing.assert_array_almost_equal([0,3/5,4/5], centroids[0])
        np.testing.assert_array_almost_equal([5/13,12/13,0], centroids[1])

        self.assertEqual(id_1, id_2)
        self.assertEqual(id_3, id_4)
        self.assertNotEqual(id_1, id_3)

    def test_add_two_clusters_agglomerative(self):
        vector_id = ClusterIdentity.agglomerative(3, 0.1)

        id_1 = vector_id.add(np.array([[0,3,4]]))
        id_2 = vector_id.add(np.array([[0,3,4]]))
        id_3 = vector_id.add(np.array([[5,12,0]]))
        id_4 = vector_id.add(np.array([[5,12,0]]))

        np.testing.assert_array_equal([[0,3,4], [0,3,4], [5,12,0], [5,12,0]], vector_id._representations)

        centroids = list(sorted([tuple(cent) for cent in vector_id._centroids.values()]))
        self.assertEqual(2, len(centroids))
        np.testing.assert_array_almost_equal([0,3/5,4/5], centroids[0])
        np.testing.assert_array_almost_equal([5/13,12/13,0], centroids[1])

        self.assertEqual(id_1, id_2)
        self.assertEqual(id_3, id_4)
        self.assertNotEqual(id_1, id_3)

    def test_add_one_dimensional_no_dim(self):
        vector_id = ClusterIdentity(TestClustering(), 0)

        vector_id.add(np.array([0,3,4]))
        vector_id.add(np.array([0,3,4]))

        np.testing.assert_array_almost_equal([[0,3,4], [0,3,4]], vector_id._representations)
        np.testing.assert_array_equal([0,3/5,4/5], next(iter(vector_id._centroids.values())))

    def test_two_dimensional_no_dim(self):
        vector_id = ClusterIdentity(TestClustering(), None)

        vector_id.add(np.array([[0,3,4]]))
        vector_id.add(np.array([[0,3,4]]))

        np.testing.assert_array_almost_equal([[0,3,4], [0,3,4]], vector_id._representations)
        np.testing.assert_array_equal([0,3/5,4/5], next(iter(vector_id._centroids.values())))

    def test_high_dimensional_runs_without_errors(self):
        vector_id = ClusterIdentity.agglomerative(0, 0.1)

        embeddings = np.array([[0.04033, 0.00239, 0.07055, 0.09924, -0.04310, 0.07525, -0.01110, 0.01596, 0.06416, 0.05910, -0.04483, 0.05125, -0.05855, -0.05928, -0.00403, 0.02286, 0.00968, -0.03060, -0.01531, -0.03746, 0.03748, 0.06572, 0.02293, -0.00569, -0.01466, -0.00888, -0.00632, 0.03012, 0.01382, -0.01228, 0.01191, 0.16940, 0.03387, 0.02397, 0.00903, 0.02465, 0.00205, -0.07306, 0.02680, -0.02877, 0.02359, 0.04737, -0.04135, -0.05056, -0.01978, -0.01763, 0.03069, 0.00032, -0.08090, 0.00094, -0.00586, 0.04093, 0.02771, 0.02459, 0.06944, 0.00071, -0.03708, -0.04547, -0.10318, 0.05844, 0.05309, 0.01828, -0.03179, -0.03322, -0.00485, -0.00210, -0.04818, 0.00546, 0.01380, -0.03014, 0.02184, 0.02099, 0.06900, 0.02351, -0.01536, -0.01016, -0.05433, 0.08255, -0.04285, 0.05843, -0.08229, 0.00036, 0.02491, -0.02762, 0.00482, -0.12327, -0.03334, -0.03007, 0.02016, -0.05876, 0.00068, -0.09427, -0.01258, -0.04339, 0.03018, 0.00575, 0.04831, -0.03926, 0.10413, -0.03389, 0.06211, 0.01196, -0.02751, -0.00988, 0.00415, -0.06509, -0.00703, -0.06321, 0.07341, -0.05424, -0.01668, 0.00818, -0.00458, 0.00525, -0.03502, 0.06170, 0.01012, 0.00049, -0.01249, -0.02000, -0.01534, 0.10848, -0.02393, 0.02286, 0.07738, 0.08010, -0.01400, 0.02722, -0.00033, -0.02480, 0.05482, -0.01097, 0.11494, 0.04828, -0.01827, 0.00134, -0.00749, 0.02994, 0.02773, 0.04519, -0.02475, 0.05796, 0.05050, 0.04872, -0.01276, -0.02734, -0.04033, 0.01013, 0.00919, -0.02973, 0.04465, 0.00021, 0.05651, 0.09445, -0.01230, -0.05934, -0.01845, 0.10338, 0.03501, 0.03109, 0.01558, -0.05732, 0.02712, -0.01635, -0.03739, -0.00266, -0.00319, -0.09630, -0.02313, -0.03269, -0.03144, -0.01556, 0.02806, 0.00924, -0.02912, 0.01189, 0.01406, -0.05153, -0.06128, 0.00834, -0.00868, -0.00074, -0.00389, -0.00802, -0.07939, 0.01557, 0.12182, -0.00703, -0.01017, 0.01102, 0.01944, -0.04896, -0.00338, 0.01844, -0.05962, -0.02939, -0.05335, -0.01685, 0.02968, -0.03075, -0.01733, -0.06617, 0.05483, 0.01320, -0.04760, 0.03735, 0.02410, 0.02813, -0.00811, -0.02431, -0.04025, 0.00576, 0.00117, -0.01600, 0.00689, -0.01046, -0.08528, 0.03169, -0.07314, 0.03689, 0.01609, 0.00001, -0.00072, -0.00448, 0.05270, -0.00982, 0.04349, -0.09122, -0.04947, -0.01843, -0.03496, -0.03000, 0.01752, 0.09247, 0.02540, 0.06841, 0.06352, -0.01256, 0.02712, -0.04180, 0.06271, 0.04539, 0.00945, 0.07932, -0.01480, 0.03554, -0.01440, 0.04069, 0.01757, 0.02244, 0.02430, -0.00831, 0.05645, 0.06505, 0.07745, 0.01845, -0.02981, -0.04835, -0.01667, -0.02113, -0.05245, 0.05671, -0.04400, -0.01225, -0.04786, 0.00103, -0.04078, -0.08605, -0.00496, -0.04065, 0.04748, -0.00478, 0.03748, -0.04453, 0.08364, -0.04519, -0.00684, 0.05084, -0.02890, -0.00700, -0.02096, 0.04153, 0.03515, -0.01792, -0.03309, 0.05893, 0.02637, -0.00431, 0.07033, 0.00499, -0.00054, 0.05145, 0.04387, -0.02458, -0.00671, 0.03880, -0.03839, -0.02496, -0.04868, -0.01856, -0.04192, 0.00546, -0.00336, 0.00726, -0.06631, 0.00260, -0.05498, 0.02930, -0.03243, 0.03494, 0.02274, -0.07325, -0.10807, 0.02638, -0.07572, -0.02212, 0.03082, -0.00272, -0.04384, -0.04343, 0.01300, 0.04498, 0.09513, 0.01833, 0.08962, -0.03986, -0.07123, 0.03996, -0.02510, 0.00112, -0.02113, 0.04241, -0.05953, 0.08315, -0.06508, 0.06429, 0.01899, 0.01246, -0.05562, -0.00176, 0.02880, -0.02638, 0.03155, 0.01540, 0.05119, -0.00766, -0.04481, -0.01422, 0.04744, -0.12099, -0.00500, -0.04346, -0.02157, 0.01607, -0.00244, 0.02529, 0.02959, 0.00014, 0.13309, 0.08373, -0.03935, -0.00256, 0.00113, -0.01074, 0.00136, -0.01882, 0.02913, -0.01240, 0.00419, -0.00051, -0.01412, 0.04257, -0.06524, -0.00483, -0.01558, 0.02257, -0.04074, 0.00540, -0.00393, -0.06017, -0.00727, 0.04464, 0.14538, 0.03216, 0.03478, 0.02100, -0.04942, 0.01112, -0.04777, 0.04297, 0.01418, -0.07953, -0.02569, 0.01094, -0.07679, -0.00175, -0.02997, -0.04855, -0.12326, -0.00889, -0.09008, 0.05064, 0.03513, 0.06133, -0.03390, 0.01198, -0.01841, 0.02175, 0.01087, 0.03350, -0.07962, 0.02406, -0.04911, 0.01107, 0.02777, -0.07081, -0.08089, -0.00920, 0.05952, 0.03411, -0.00990, 0.01099, 0.04342, 0.01350, 0.05692, 0.01096, 0.00301, -0.03264, 0.01046, 0.02887, 0.00121, -0.00910, -0.00247, -0.01692, -0.01378, -0.02340, 0.00238, -0.11213, 0.00418, 0.04075, 0.05929, -0.03632, 0.04193, -0.05112, 0.04744, -0.05729, -0.02945, -0.01829, -0.00158, -0.03728, 0.04031, 0.02916, -0.01572, -0.03900, -0.00022, 0.02546, 0.03716, -0.04563, -0.03336, -0.03434, -0.00337, -0.01006, -0.02266, 0.07467, 0.07370, 0.00888, 0.07410, -0.00395, -0.01964, 0.04145, -0.02950, 0.01563, -0.02839, -0.00493, 0.00565, 0.01605, -0.03027, -0.02687, -0.00613, 0.04908, -0.02012, 0.01820, -0.01714, 0.08532, 0.00312, 0.03582, -0.08793, -0.08372, 0.02182, -0.02731, -0.06593, -0.04387, 0.04224, 0.02507, 0.05928, -0.02970, 0.07124, -0.06781, -0.01801, 0.03498, 0.01998, 0.03776, 0.05945, 0.07820, -0.02244, -0.07771, 0.00959, -0.06342, 0.04917, -0.02134, 0.04325, 0.03237],
                               [0.04033, 0.00239, 0.07055, 0.09924, -0.04310, 0.07525, -0.01110, 0.01596, 0.06416, 0.05910, -0.04483, 0.05125, -0.05855, -0.05928, -0.00403, 0.02286, 0.00968, -0.03060, -0.01531, -0.03746, 0.03748, 0.06572, 0.02293, -0.00569, -0.01466, -0.00888, -0.00632, 0.03012, 0.01382, -0.01228, 0.01191, 0.16940, 0.03387, 0.02397, 0.00903, 0.02465, 0.00205, -0.07306, 0.02680, -0.02877, 0.02359, 0.04737, -0.04135, -0.05056, -0.01978, -0.01763, 0.03069, 0.00032, -0.08090, 0.00094, -0.00586, 0.04093, 0.02771, 0.02459, 0.06944, 0.00071, -0.03708, -0.04547, -0.10318, 0.05844, 0.05309, 0.01828, -0.03179, -0.03322, -0.00485, -0.00210, -0.04818, 0.00546, 0.01380, -0.03014, 0.02184, 0.02099, 0.06900, 0.02351, -0.01536, -0.01016, -0.05433, 0.08255, -0.04285, 0.05843, -0.08229, 0.00036, 0.02491, -0.02762, 0.00482, -0.12327, -0.03334, -0.03007, 0.02016, -0.05876, 0.00068, -0.09427, -0.01258, -0.04339, 0.03018, 0.00575, 0.04831, -0.03926, 0.10413, -0.03389, 0.06211, 0.01196, -0.02751, -0.00988, 0.00415, -0.06509, -0.00703, -0.06321, 0.07341, -0.05424, -0.01668, 0.00818, -0.00458, 0.00525, -0.03502, 0.06170, 0.01012, 0.00049, -0.01249, -0.02000, -0.01534, 0.10848, -0.02393, 0.02286, 0.07738, 0.08010, -0.01400, 0.02722, -0.00033, -0.02480, 0.05482, -0.01097, 0.11494, 0.04828, -0.01827, 0.00134, -0.00749, 0.02994, 0.02773, 0.04519, -0.02475, 0.05796, 0.05050, 0.04872, -0.01276, -0.02734, -0.04033, 0.01013, 0.00919, -0.02973, 0.04465, 0.00021, 0.05651, 0.09445, -0.01230, -0.05934, -0.01845, 0.10338, 0.03501, 0.03109, 0.01558, -0.05732, 0.02712, -0.01635, -0.03739, -0.00266, -0.00319, -0.09630, -0.02313, -0.03269, -0.03144, -0.01556, 0.02806, 0.00924, -0.02912, 0.01189, 0.01406, -0.05153, -0.06128, 0.00834, -0.00868, -0.00074, -0.00389, -0.00802, -0.07939, 0.01557, 0.12182, -0.00703, -0.01017, 0.01102, 0.01944, -0.04896, -0.00338, 0.01844, -0.05962, -0.02939, -0.05335, -0.01685, 0.02968, -0.03075, -0.01733, -0.06617, 0.05483, 0.01320, -0.04760, 0.03735, 0.02410, 0.02813, -0.00811, -0.02431, -0.04025, 0.00576, 0.00117, -0.01600, 0.00689, -0.01046, -0.08528, 0.03169, -0.07314, 0.03689, 0.01609, 0.00001, -0.00072, -0.00448, 0.05270, -0.00982, 0.04349, -0.09122, -0.04947, -0.01843, -0.03496, -0.03000, 0.01752, 0.09247, 0.02540, 0.06841, 0.06352, -0.01256, 0.02712, -0.04180, 0.06271, 0.04539, 0.00945, 0.07932, -0.01480, 0.03554, -0.01440, 0.04069, 0.01757, 0.02244, 0.02430, -0.00831, 0.05645, 0.06505, 0.07745, 0.01845, -0.02981, -0.04835, -0.01667, -0.02113, -0.05245, 0.05671, -0.04400, -0.01225, -0.04786, 0.00103, -0.04078, -0.08605, -0.00496, -0.04065, 0.04748, -0.00478, 0.03748, -0.04453, 0.08364, -0.04519, -0.00684, 0.05084, -0.02890, -0.00700, -0.02096, 0.04153, 0.03515, -0.01792, -0.03309, 0.05893, 0.02637, -0.00431, 0.07033, 0.00499, -0.00054, 0.05145, 0.04387, -0.02458, -0.00671, 0.03880, -0.03839, -0.02496, -0.04868, -0.01856, -0.04192, 0.00546, -0.00336, 0.00726, -0.06631, 0.00260, -0.05498, 0.02930, -0.03243, 0.03494, 0.02274, -0.07325, -0.10807, 0.02638, -0.07572, -0.02212, 0.03082, -0.00272, -0.04384, -0.04343, 0.01300, 0.04498, 0.09513, 0.01833, 0.08962, -0.03986, -0.07123, 0.03996, -0.02510, 0.00112, -0.02113, 0.04241, -0.05953, 0.08315, -0.06508, 0.06429, 0.01899, 0.01246, -0.05562, -0.00176, 0.02880, -0.02638, 0.03155, 0.01540, 0.05119, -0.00766, -0.04481, -0.01422, 0.04744, -0.12099, -0.00500, -0.04346, -0.02157, 0.01607, -0.00244, 0.02529, 0.02959, 0.00014, 0.13309, 0.08373, -0.03935, -0.00256, 0.00113, -0.01074, 0.00136, -0.01882, 0.02913, -0.01240, 0.00419, -0.00051, -0.01412, 0.04257, -0.06524, -0.00483, -0.01558, 0.02257, -0.04074, 0.00540, -0.00393, -0.06017, -0.00727, 0.04464, 0.14538, 0.03216, 0.03478, 0.02100, -0.04942, 0.01112, -0.04777, 0.04297, 0.01418, -0.07953, -0.02569, 0.01094, -0.07679, -0.00175, -0.02997, -0.04855, -0.12326, -0.00889, -0.09008, 0.05064, 0.03513, 0.06133, -0.03390, 0.01198, -0.01841, 0.02175, 0.01087, 0.03350, -0.07962, 0.02406, -0.04911, 0.01107, 0.02777, -0.07081, -0.08089, -0.00920, 0.05952, 0.03411, -0.00990, 0.01099, 0.04342, 0.01350, 0.05692, 0.01096, 0.00301, -0.03264, 0.01046, 0.02887, 0.00121, -0.00910, -0.00247, -0.01692, -0.01378, -0.02340, 0.00238, -0.11213, 0.00418, 0.04075, 0.05929, -0.03632, 0.04193, -0.05112, 0.04744, -0.05729, -0.02945, -0.01829, -0.00158, -0.03728, 0.04031, 0.02916, -0.01572, -0.03900, -0.00022, 0.02546, 0.03716, -0.04563, -0.03336, -0.03434, -0.00337, -0.01006, -0.02266, 0.07467, 0.07370, 0.00888, 0.07410, -0.00395, -0.01964, 0.04145, -0.02950, 0.01563, -0.02839, -0.00493, 0.00565, 0.01605, -0.03027, -0.02687, -0.00613, 0.04908, -0.02012, 0.01820, -0.01714, 0.08532, 0.00312, 0.03582, -0.08793, -0.08372, 0.02182, -0.02731, -0.06593, -0.04387, 0.04224, 0.02507, 0.05928, -0.02970, 0.07124, -0.06781, -0.01801, 0.03498, 0.01998, 0.03776, 0.05945, 0.07820, -0.02244, -0.07771, 0.00959, -0.06342, 0.04917, -0.02134, 0.04325, 0.03237],
                               [0.02892, 0.01239, 0.06904, 0.10118, -0.02539, 0.07344, -0.00923, 0.02611, 0.06155, 0.06609, -0.04307, 0.05594, -0.05395, -0.05007, 0.00031, 0.03520, -0.00577, -0.02814, -0.00269, -0.04223, 0.06196, 0.06396, 0.02535, 0.00702, -0.02523, -0.01090, -0.02258, 0.02856, 0.02846, -0.00285, 0.00963, 0.16410, 0.02590, 0.02256, 0.00615, 0.01398, 0.02125, -0.08144, 0.02230, -0.03225, 0.03765, 0.03224, -0.04608, -0.04299, -0.01251, -0.02514, 0.02386, 0.00573, -0.06156, -0.00639, 0.00604, 0.04942, 0.02815, 0.03745, 0.05497, 0.00174, -0.05225, -0.03044, -0.10221, 0.07933, 0.05343, 0.00353, -0.03898, -0.02526, 0.00189, 0.00410, -0.04996, -0.00231, 0.01187, -0.03422, 0.02346, 0.01522, 0.06910, 0.01348, 0.00128, -0.00886, -0.04078, 0.08003, -0.05794, 0.05112, -0.06415, -0.00686, 0.03857, -0.03015, 0.00311, -0.12569, -0.02077, -0.03448, 0.01948, -0.05612, 0.01959, -0.07930, -0.03030, -0.04492, 0.01647, 0.02214, 0.05075, -0.02099, 0.11370, -0.03972, 0.06092, 0.02521, -0.02703, -0.01003, 0.00595, -0.08890, -0.00262, -0.04979, 0.08475, -0.06805, -0.00140, 0.00885, -0.01290, -0.00974, -0.03571, 0.06825, 0.02018, -0.00003, 0.00120, -0.02436, -0.01846, 0.10365, -0.03352, 0.01550, 0.05997, 0.08899, 0.00082, 0.01776, 0.00896, -0.03590, 0.06514, -0.00904, 0.10284, 0.03760, -0.02353, -0.01495, -0.02716, 0.02007, 0.04145, 0.04884, -0.01825, 0.06778, 0.04925, 0.05329, -0.01801, -0.01802, -0.03471, 0.00139, 0.00840, -0.02923, 0.02716, 0.00948, 0.05660, 0.12103, -0.01066, -0.06979, -0.02736, 0.08562, 0.03934, 0.03827, 0.01491, -0.04906, 0.02268, -0.01566, -0.02556, 0.01524, 0.00295, -0.09084, -0.04112, -0.03255, -0.04540, 0.00716, 0.02494, 0.01591, -0.03283, 0.01725, 0.00914, -0.05802, -0.04675, -0.00706, -0.00547, -0.01689, -0.00232, -0.02345, -0.09448, 0.01360, 0.11957, -0.00198, -0.00295, -0.00046, 0.01409, -0.03203, 0.01677, 0.02561, -0.05951, -0.03784, -0.06084, -0.01853, 0.04854, -0.02540, -0.00405, -0.07095, 0.05765, 0.01319, -0.05088, 0.04687, 0.03290, 0.02855, -0.02171, -0.01476, -0.04762, 0.01217, 0.01038, -0.01467, 0.01835, 0.00156, -0.09282, 0.02592, -0.06296, 0.02736, 0.00032, 0.00534, -0.00784, -0.01305, 0.03847, -0.01238, 0.04436, -0.09184, -0.03949, -0.00590, -0.04203, -0.01994, 0.02481, 0.10413, 0.01734, 0.08008, 0.06446, -0.01551, 0.00897, -0.03008, 0.05995, 0.07432, -0.00044, 0.07618, -0.00964, 0.02145, -0.01426, 0.04250, 0.02899, 0.02961, 0.03156, -0.00864, 0.05388, 0.08591, 0.06232, 0.00470, -0.03393, -0.04092, 0.00506, -0.01653, -0.04799, 0.05307, -0.04500, -0.01052, -0.04031, 0.01675, -0.03941, -0.06101, -0.01497, -0.02164, 0.04749, -0.00138, 0.04757, -0.04463, 0.07097, -0.04524, -0.00669, 0.03584, -0.03499, -0.01290, -0.02871, 0.02307, 0.03487, -0.01594, -0.03183, 0.05729, 0.00549, -0.02286, 0.06479, 0.00635, -0.00541, 0.05281, 0.06490, -0.00431, 0.01079, 0.03848, -0.03457, -0.02578, -0.03751, -0.01442, -0.04553, -0.00291, 0.01023, -0.00236, -0.05831, -0.00275, -0.05826, 0.02847, -0.01855, 0.01856, 0.00722, -0.06207, -0.09809, 0.03391, -0.04967, -0.01502, 0.04573, -0.01160, -0.03362, -0.03710, 0.02103, 0.03824, 0.08679, 0.00463, 0.07986, -0.02182, -0.07972, 0.02909, -0.01727, 0.00262, -0.01641, 0.04066, -0.02770, 0.07716, -0.07818, 0.04754, 0.01946, 0.01306, -0.06755, 0.00823, 0.01056, -0.04248, 0.02747, 0.03132, 0.06666, -0.00127, -0.05665, -0.00158, 0.05879, -0.10661, -0.00518, -0.02763, -0.01107, 0.02895, 0.00237, 0.01585, 0.02414, 0.01013, 0.13103, 0.06717, -0.04798, 0.00828, -0.00906, -0.00358, 0.00184, -0.03741, 0.01852, -0.00835, -0.00087, -0.00815, -0.01999, 0.05968, -0.05872, -0.00859, -0.00531, 0.02715, -0.04705, -0.00684, -0.00925, -0.06641, -0.00791, 0.04100, 0.13947, 0.02792, 0.02961, 0.02630, -0.04625, 0.00889, -0.06984, 0.06152, 0.01818, -0.07037, -0.03451, 0.00826, -0.09336, -0.00921, -0.02133, -0.04283, -0.12100, -0.00574, -0.09671, 0.04782, 0.01671, 0.04920, -0.04150, 0.01889, 0.00443, 0.01866, 0.00136, 0.03953, -0.09029, 0.02823, -0.06941, 0.01975, 0.01669, -0.07498, -0.08415, -0.00396, 0.06438, 0.03577, -0.00241, 0.00403, 0.03149, 0.02596, 0.05991, 0.01763, -0.01346, -0.02878, 0.00782, 0.03779, 0.00240, 0.00753, -0.01187, -0.01739, -0.00959, -0.01361, 0.00142, -0.10783, -0.00972, 0.03533, 0.04468, -0.02207, 0.04387, -0.03239, 0.04154, -0.05679, -0.01492, -0.02030, -0.00074, -0.04791, 0.02151, 0.03442, -0.01083, -0.01846, 0.00382, 0.03529, 0.03504, -0.07250, -0.02562, -0.04813, -0.02211, -0.02131, -0.01206, 0.08506, 0.05903, -0.00402, 0.08577, -0.01530, -0.00867, 0.05325, -0.02096, 0.01049, -0.03004, -0.01568, 0.01337, 0.01352, -0.02663, -0.04555, -0.02050, 0.06758, -0.00345, 0.03270, -0.01304, 0.08042, 0.00325, 0.04651, -0.07734, -0.07054, 0.02896, -0.02378, -0.06576, -0.04744, 0.05630, 0.02033, 0.07144, -0.04003, 0.06372, -0.08130, -0.00083, 0.03400, 0.01527, 0.05078, 0.06392, 0.05919, -0.02696, -0.07252, -0.00300, -0.06393, 0.02744, -0.03356, 0.05106, 0.01642],
                               [0.00301, 0.01980, 0.02526, 0.08707, -0.03825, 0.03706, 0.01231, -0.04443, 0.08058, 0.08016, -0.08023, 0.03012, -0.06987, 0.00292, -0.03454, 0.04167, -0.02099, -0.02780, -0.02799, -0.02222, 0.02216, 0.05898, -0.00420, -0.00122, 0.01617, -0.00065, 0.02156, 0.00609, 0.03158, -0.03731, -0.00867, 0.16330, 0.04699, 0.06543, 0.02812, -0.01104, 0.03131, -0.05881, 0.01563, -0.05821, 0.03758, 0.04258, -0.04367, -0.04314, -0.01046, -0.00581, 0.01848, 0.02866, -0.03920, 0.00594, 0.04909, 0.01028, 0.03971, 0.01972, 0.01572, -0.01848, -0.04765, -0.04797, -0.10060, 0.06017, 0.05142, -0.02156, 0.01637, -0.00220, -0.03862, 0.04269, -0.02313, -0.00674, 0.03153, -0.02647, 0.04231, -0.00238, 0.03962, 0.00804, 0.01426, 0.00626, -0.02581, 0.07277, -0.01288, 0.03166, -0.04249, 0.02453, 0.03942, -0.05435, 0.00365, -0.12359, -0.00762, -0.02489, 0.01503, -0.03804, 0.01482, -0.09906, 0.00476, -0.03890, 0.00833, 0.02092, -0.00591, -0.00252, 0.08603, -0.03639, 0.05676, 0.00623, -0.00397, -0.05091, 0.02681, -0.02545, -0.01398, -0.02580, 0.07699, -0.05578, -0.01785, 0.00267, 0.01723, -0.00974, -0.01544, 0.07322, 0.02426, 0.05081, 0.01736, -0.04235, 0.01082, 0.04822, -0.00495, 0.02194, 0.05785, 0.08306, 0.02316, 0.03842, 0.00931, -0.04812, 0.02690, -0.04104, 0.12348, 0.04883, 0.01535, -0.02456, -0.00945, 0.06651, 0.05242, 0.03146, 0.01042, 0.05959, 0.02539, 0.03886, -0.00392, -0.02041, -0.03199, 0.00664, -0.01002, 0.00890, 0.08169, 0.02374, 0.05006, 0.09092, -0.01983, -0.06332, -0.02515, 0.08685, 0.05741, 0.01545, 0.04516, -0.01312, -0.00512, 0.02489, -0.01729, 0.02650, 0.03809, -0.07181, 0.00551, 0.00877, -0.04692, 0.03147, 0.02151, -0.00672, -0.03295, 0.00956, 0.00217, -0.04699, -0.06473, 0.01351, -0.00546, -0.00511, -0.03593, -0.00472, -0.07508, 0.01174, 0.08194, 0.03873, -0.00886, -0.00735, -0.02901, -0.03082, 0.03133, 0.02646, -0.04729, -0.01440, -0.02492, -0.02171, 0.07006, -0.03921, -0.01942, -0.06808, 0.07346, 0.02709, -0.04486, 0.03182, -0.01028, 0.02593, -0.04363, -0.00615, -0.01876, -0.01552, -0.03234, -0.00091, 0.00516, -0.01500, -0.07374, 0.05309, -0.05647, 0.09266, 0.00455, -0.02981, -0.01817, 0.02838, 0.07184, 0.00870, 0.00279, -0.09360, -0.03429, -0.04415, -0.08157, -0.00425, 0.00626, 0.07986, -0.00747, 0.05306, 0.05180, -0.05034, 0.01147, -0.04784, 0.04976, 0.05669, 0.00419, 0.08467, 0.02329, 0.00468, -0.07050, 0.07885, 0.01272, 0.01100, 0.01521, -0.03520, 0.03102, 0.05072, 0.02512, -0.01778, -0.03262, -0.05039, -0.04319, -0.01440, -0.04749, 0.04833, -0.08283, -0.03095, -0.05953, 0.05053, -0.03244, -0.05661, -0.00939, 0.00122, 0.06019, 0.04283, 0.07068, -0.04271, 0.07133, -0.05971, -0.03041, 0.01428, -0.02028, -0.01436, 0.01745, 0.01094, -0.00028, 0.00494, -0.09653, 0.07037, 0.01450, -0.05608, 0.07973, 0.04807, 0.03536, 0.02571, 0.04628, 0.00286, 0.02988, 0.03103, -0.00065, -0.03346, -0.04815, -0.06137, -0.01851, 0.02752, -0.02768, -0.00967, -0.02525, 0.00870, -0.05806, 0.03590, -0.03904, -0.01950, -0.01229, -0.07079, -0.04694, 0.02228, -0.07656, -0.01553, 0.04063, 0.02056, -0.02595, -0.00061, 0.00301, 0.06353, 0.06846, 0.05541, 0.10408, 0.00581, -0.11689, 0.04512, 0.00255, -0.03881, -0.04250, 0.10198, -0.05177, 0.11499, -0.07948, 0.06238, 0.01868, 0.05451, -0.08599, 0.03904, 0.01109, -0.02391, 0.01331, 0.00244, 0.04326, -0.00714, -0.04692, -0.01947, 0.03226, -0.10518, 0.02198, -0.06559, -0.02566, 0.03266, -0.03576, 0.01706, 0.01023, 0.01434, 0.13100, 0.02553, -0.04959, -0.01304, -0.01013, -0.00162, 0.01094, -0.00203, 0.03979, -0.00759, -0.00984, 0.03527, -0.05675, 0.04397, -0.07642, 0.01838, -0.01230, -0.00020, -0.03639, 0.00679, -0.03341, -0.04589, 0.01508, 0.04012, 0.11716, 0.01208, 0.03689, 0.02974, -0.04841, -0.00710, -0.04253, 0.02848, -0.01307, -0.08110, -0.03218, -0.02152, -0.04846, -0.00062, -0.00422, -0.02657, -0.13152, 0.03211, -0.08104, 0.00753, 0.00662, 0.03154, -0.03655, -0.01962, 0.00208, 0.03393, -0.00298, 0.03335, -0.08249, 0.05726, -0.02676, 0.03427, -0.00876, -0.02830, -0.07917, -0.00354, 0.05993, 0.01882, -0.02362, 0.00671, 0.01712, 0.03071, 0.08472, 0.01710, -0.01445, -0.01925, 0.01344, -0.00359, 0.02990, -0.00957, 0.00141, -0.02243, -0.04182, -0.03302, 0.00600, -0.12942, -0.02792, 0.02687, 0.06445, -0.02985, 0.04846, -0.04175, 0.06355, -0.02963, -0.04841, 0.00318, 0.00293, -0.07642, -0.00460, 0.02437, -0.01900, 0.00312, -0.01605, 0.05242, 0.03680, -0.03525, -0.05226, -0.05087, -0.02071, -0.02734, 0.01003, 0.09703, 0.03219, 0.04502, 0.03570, 0.02261, -0.02165, 0.04358, -0.05981, 0.02757, 0.02922, -0.00217, 0.00901, -0.01623, -0.00336, -0.01608, 0.00738, 0.04244, -0.00395, 0.01614, -0.02128, 0.09502, -0.02093, 0.01663, -0.08324, -0.08566, 0.00828, -0.02045, -0.03394, -0.04493, 0.06993, 0.02578, -0.01257, -0.03750, 0.06890, -0.05528, -0.04549, 0.03466, 0.05628, 0.03459, 0.06806, 0.06389, -0.04482, -0.10843, 0.00774, -0.02564, 0.00995, -0.00388, 0.02106, -0.00077]])

        vector_id.add(embeddings)
        vector_id.add(embeddings)